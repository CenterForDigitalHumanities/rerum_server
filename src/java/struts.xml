<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>
    <include file="struts-notification.xml" />
    <constant name="struts.i18n.reload" value="false" />
    <constant name="struts.devMode" value="false" />
    <constant name="struts.objectFactory" value="spring" />
    <constant name="struts.multipart.saveDir" value="/tmp"></constant>
    
    <package name="default" extends="struts-default"></package>
    
    <!-- This package is open to public -->
    <package name="getObject" extends="default" namespace="/id">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>
            <interceptor-stack name="myDefault">
                <interceptor-ref name="responseEncoding" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        
        <action name="getByID" class="objectAction" method="getByID"></action>
    </package>
    
    <!-- OBJECTS -->
    <package name="v1" extends="default" namespace="/v1">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="requestServerAuthenticationFilter" class="edu.slu.filter.RequestServerAuthenticationFilter">
                <param name="includeMethods">saveNewObject, batchSaveFromCopy, updateObject, deleteObject </param>
            </interceptor>
            <interceptor name="getRequestClientInfoRecorder" class="edu.slu.filter.GetRequestClientInfoRecorder">
                <param name="includeMethods">getbyProperties, getByID, getAllAncestors, getAllDescendants, getAllVersions</param>
            </interceptor>
            <!--<interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>-->
            <interceptor name="inSessionFilter" class="edu.slu.filter.InSessionFilter"></interceptor>
            <interceptor-stack name="myDefault">
                <!--<interceptor-ref name="responseEncoding" />-->
                <interceptor-ref name="inSessionFilter" />
                <interceptor-ref name="requestServerAuthenticationFilter" />
                <interceptor-ref name="getRequestClientInfoRecorder" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        <!-- this tells the app what to do when the result is a 403 string.  @see RequestServerAuthenticationFilter.java && AnnotationAction.java -->
        <global-results>
            <result name="403">/403.jsp</result>
        </global-results>
        
        <action name="getByProperties" class="objectAction" method="getByProperties"></action>
        <action name="getByID" class="objectAction" method="getByID"></action>
        <action name="getAllAncestors" class="objectAction" method="getAllAncestors"></action>
        <action name="getAllDescendents" class="objectAction" method="getAllDescendents"></action>
        <action name="create" class="objectAction" method="saveNewObject"></action>
        <action name="update" class="objectAction" method="updateObject"></action>
        <action name="delete" class="objectAction" method="deleteObject"></action>
    </package>
    
    <!-- ACCEPTED SERVER -->
    <package name="acceptedServer" extends="default" namespace="/acceptedServer">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>
            <interceptor-stack name="myDefault">
                <interceptor-ref name="responseEncoding" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        
        <action name="saveNewServer" class="serverAction" method="saveNewServer"></action>
        <action name="updateServerByObjectID" class="serverAction" method="updateServerByObjectID"></action>
        <action name="getServerByIp" class="serverAction" method="getServerByIp"></action>
    </package>
    
</struts>

