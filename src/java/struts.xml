<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>
    <include file="struts-notification.xml" />
    <constant name="struts.i18n.reload" value="false" />
    <constant name="struts.devMode" value="false" />
    <constant name="struts.objectFactory" value="spring" />
    <constant name="struts.multipart.saveDir" value="/tmp"></constant>
    
    <package name="default" extends="struts-default"></package>
    
    <!-- This package is open to public -->
    <package name="getAnnotation" extends="default" namespace="/id">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>
            <interceptor-stack name="myDefault">
                <interceptor-ref name="responseEncoding" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        
        <action name="getAnnotationByObjectID" class="annotationAction" method="getAnnotationByObjectID"></action>
    </package>
    
    <!-- ANNOTATION -->
    <package name="anno" extends="default" namespace="/anno">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="requestServerAuthenticationFilter" class="edu.slu.filter.RequestServerAuthenticationFilter">
                <param name="includeMethods">saveNewAnnotation, batchSaveFromCopy, updateAnnotation, saveNewVersionOfAnnotation, deleteAnnotationByObjectID, 
                deleteAnnotationByAtID, forkAnnotation, saveForkAnnotation</param>
            </interceptor>
            <interceptor name="getRequestClientInfoRecorder" class="edu.slu.filter.GetRequestClientInfoRecorder">
                <param name="includeMethods">getAnnotationByProperties, getAnnotationByObjectID, getAllMyAnnotations, getAllVersionsOfAnnotationByObjectID, 
                getAllVersionsOfAnnotationByOriginalAnnoID, getAnnoByResourceOutterRelativeNamespace</param>
            </interceptor>
            <!--<interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>-->
            <interceptor name="inSessionFilter" class="edu.slu.filter.InSessionFilter"></interceptor>
            <interceptor-stack name="myDefault">
                <!--<interceptor-ref name="responseEncoding" />-->
                <interceptor-ref name="inSessionFilter" />
                <interceptor-ref name="requestServerAuthenticationFilter" />
                <interceptor-ref name="getRequestClientInfoRecorder" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
<!--        <global-results>
            <result name="403">/403.jsp</result>
        </global-results>-->
        
        <action name="getAnnotationByProperties" class="annotationAction" method="getAnnotationByProperties"></action>
        <action name="getAnnotationByObjectID" class="annotationAction" method="getAnnotationByObjectID"></action>
        <action name="getAllMyAnnotations" class="annotationAction" method="getAllMyAnnotations"></action>
        <action name="getAllVersionsOfAnnotationByObjectID" class="annotationAction" method="getAllVersionsOfAnnotationByObjectID"></action>
        <action name="getAllVersionsOfAnnotationByOriginalAnnoID" class="annotationAction" method="getAllVersionsOfAnnotationByOriginalAnnoID"></action>
        <action name="getAnnoByResourceOutterRelativeNamespace" class="annotationAction" method="getAnnoByResourceOutterRelativeNamespace"></action>
        <action name="saveNewAnnotation" class="annotationAction" method="saveNewAnnotation"></action>
        <action name="updateAnnotation" class="annotationAction" method="updateAnnotation"></action>
        <action name="saveNewVersionOfAnnotation" class="annotationAction" method="saveNewVersionOfAnnotation"></action>
        <action name="deleteAnnotationByObjectID" class="annotationAction" method="deleteAnnotationByObjectID"></action>
        <action name="deleteAnnotationByAtID" class="annotationAction" method="deleteAnnotationByAtID"></action>
        <action name="forkAnnotation" class="annotationAction" method="forkAnnotation"></action>
        <action name="saveForkAnnotation" class="annotationAction" method="saveForkAnnotation"></action>
        <action name="batchSaveFromCopy" class="annotationAction" method="batchSaveFromCopy"></action>
        <action name="batchSaveMetadataForm" class="annotationAction" method="batchSaveMetadataForm"></action>
    </package>
    
    <!-- ACCEPTED SERVER -->
    <package name="acceptedServer" extends="default" namespace="/acceptedServer">
        <!-- INTERCEPTOR -->
        <interceptors>
            <interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>
            <interceptor-stack name="myDefault">
                <interceptor-ref name="responseEncoding" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        
        <action name="saveNewServer" class="serverAction" method="saveNewServer"></action>
        <action name="updateServerByObjectID" class="serverAction" method="updateServerByObjectID"></action>
        <action name="getServerByIp" class="serverAction" method="getServerByIp"></action>
    </package>
    
    <!-- USER MANAGEMENT -->
    <package name="user" extends="default" namespace="/user">
        <!-- INTERCEPTER -->
        <interceptors>
            <interceptor name="responseEncoding" class="edu.slu.filter.ResponseEncoding"></interceptor>
            <interceptor name="inSessionFilter" class="edu.slu.filter.InSessionFilter">
                <param name="includeMethods">
                    updateUserInfo,addProjectToUser,updateProjectUserProfile
                </param>
            </interceptor>
            <interceptor-stack name="myDefault">
                <interceptor-ref name="responseEncoding" />
                <interceptor-ref name="inSessionFilter" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="myDefault" />
        
        <!-- ACTIONS -->
        <action name="checkDuEmail" class="serverAction" method="checkDuEmail"></action>
        <action name="saveNewAgentPerson" class="serverAction" method="saveNewUser"></action>
        <action name="updateUserInfo" class="serverAction" method="updateUserInfo"></action>
        <action name="addProjectToUser" class="serverAction" method="addProjectToUser"></action>
        <action name="updateProjectUserProfile" class="serverAction" method="updateProjectUserProfile"></action>
        <action name="userLogin" class="serverAction" method="userLogin"></action>
    </package>
    
</struts>

